# üõ°Ô∏è ru-guard.js

<p align="center">
  <img src="https://img.shields.io/badge/version-2.0.0-7c3aed?style=flat-square" alt="version"/>
  <img src="https://img.shields.io/badge/license-MIT-7c3aed?style=flat-square" alt="license"/>
  <img src="https://img.shields.io/badge/dependencies-0-7c3aed?style=flat-square" alt="zero dependencies"/>
  <img src="https://img.shields.io/badge/size-~3kb-7c3aed?style=flat-square" alt="size"/>
</p>

<p align="center">
  <b>RU</b> ¬∑ <a href="#english">EN</a>
</p>

---

–õ—ë–≥–∫–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –±–µ–∑ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π, –∫–æ—Ç–æ—Ä–∞—è –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏–∑ –†–æ—Å—Å–∏–∏ –∏ —É–ø—Ä–∞–≤–ª—è–µ—Ç –≤–∏–¥–∏–º–æ—Å—Ç—å—é –∫–æ–Ω—Ç–µ–Ω—Ç–∞ ‚Äî —Å–∫—Ä—ã–≤–∞–µ—Ç, —Ä–∞–∑–º—ã–≤–∞–µ—Ç –∏–ª–∏ –ø–æ–º–µ—á–∞–µ—Ç –±–ª–æ–∫–∏ —Ä–µ–≥–∏–æ–Ω–∞–ª—å–Ω—ã–º–∏ —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏, –ø–æ–º–æ–≥–∞—è —Å–æ–±–ª—é–¥–∞—Ç—å —Ä–æ—Å—Å–∏–π—Å–∫–æ–µ –∑–∞–∫–æ–Ω–æ–¥–∞—Ç–µ–ª—å—Å—Ç–≤–æ. –û–¥–∏–Ω —Ñ–∞–π–ª, –Ω–æ–ª—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π.

```html
<!-- –ê–≤—Ç–æ-—Ä–µ–∂–∏–º, –Ω—É–ª–µ–≤–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è -->
<script src="ru-guard.js" data-auto></script>
```

---

## –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

- [–ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç](#–∫–∞–∫-—ç—Ç–æ-—Ä–∞–±–æ—Ç–∞–µ—Ç)
- [–ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç](#–±—ã—Å—Ç—Ä—ã–π-—Å—Ç–∞—Ä—Ç)
- [CSS-–∫–ª–∞—Å—Å—ã](#css-–∫–ª–∞—Å—Å—ã)
- [–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è](#–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è)
- [–ü—É–±–ª–∏—á–Ω–æ–µ API](#–ø—É–±–ª–∏—á–Ω–æ–µ-api)
- [–¢–æ—á–Ω–æ—Å—Ç—å –¥–µ—Ç–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è](#—Ç–æ—á–Ω–æ—Å—Ç—å-–¥–µ—Ç–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è)
- [–°–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π IP API](#—Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π-ip-api)
- [–ü–æ–¥–¥–µ—Ä–∂–∫–∞ –±—Ä–∞—É–∑–µ—Ä–æ–≤](#–ø–æ–¥–¥–µ—Ä–∂–∫–∞-–±—Ä–∞—É–∑–µ—Ä–æ–≤)
- [–õ–∏—Ü–µ–Ω–∑–∏—è](#–ª–∏—Ü–µ–Ω–∑–∏—è)

---

## –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞—Ö–æ–¥–∏—Ç –Ω–∞ —Å–∞–π—Ç
        ‚îÇ
        ‚ñº
–ó–∞–ø—Ä–æ—Å –∫ ipapi.co (IP-–≥–µ–æ–ª–æ–∫–∞—Ü–∏—è)
        ‚îÇ
   ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îê
—É—Å–ø–µ—Ö      –æ—à–∏–±–∫–∞
   ‚îÇ           ‚îÇ
   ‚ñº           ‚ñº
–°—Ç—Ä–∞–Ω–∞      –ó–∞–ø—Ä–æ—Å –∫ ip-api.com (—Ä–µ–∑–µ—Ä–≤)
–ø–æ IP           ‚îÇ
   ‚îÇ       ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îê
   ‚îÇ    —É—Å–ø–µ—Ö      –æ—à–∏–±–∫–∞
   ‚îÇ       ‚îÇ           ‚îÇ
   ‚îÇ       ‚ñº           ‚ñº
   ‚îÇ    –°—Ç—Ä–∞–Ω–∞      Timezone
   ‚îÇ    –ø–æ IP       –ø–æ Intl API
   ‚îÇ       ‚îÇ           ‚îÇ
   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                ‚îÇ
                ‚ñº
     –ü—Ä–∏–º–µ–Ω—è–µ–º —Ä–µ–∂–∏–º –¥–µ—Ç–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:
     'ip|timezone'  ‚Üí IP –∏–ª–∏ TZ —Å–æ–≤–ø–∞–ª
     'ip+timezone'  ‚Üí IP –∏ TZ —Å–æ–≤–ø–∞–ª–∏
     'ip'           ‚Üí —Ç–æ–ª—å–∫–æ IP
     'timezone'     ‚Üí —Ç–æ–ª—å–∫–æ TZ
                ‚îÇ
          ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
       –†–æ—Å—Å–∏—è      –ù–µ –†–æ—Å—Å–∏—è
          ‚îÇ             ‚îÇ
          ‚ñº             ‚ñº
     ru-hide        ru-only ‚Üí —Å–∫—Ä—ã—Ç—å
     ru-censor      ru-only-alert ‚Üí –æ–≤–µ—Ä–ª–µ–π
     ru-censor-alert
     ru-censor-words
```

–ï—Å–ª–∏ –æ–±–∞ IP API –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã ‚Äî –¥–µ—Ç–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –ø–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç—Å—è –Ω–∞ —á–∞—Å–æ–≤–æ–π –ø–æ—è—Å. –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ –ø–æ–∫—Ä—ã–≤–∞–µ—Ç –≤—Å–µ 20 —Ä–æ—Å—Å–∏–π—Å–∫–∏—Ö IANA-–∑–æ–Ω –æ—Ç –ö–∞–ª–∏–Ω–∏–Ω–≥—Ä–∞–¥–∞ –¥–æ –ê–Ω–∞–¥—ã—Ä—è.

---

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –ê–≤—Ç–æ-—Ä–µ–∂–∏–º

```html
<script src="ru-guard.js" data-auto></script>
```

–ê—Ç—Ä–∏–±—É—Ç `data-auto` –∑–∞–ø—É—Å–∫–∞–µ—Ç `RuGuard.init()` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ —Å–∫—Ä–∏–ø—Ç–∞.

### –†—É—á–Ω–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è

```html
<script src="ru-guard.js"></script>
<script>
  RuGuard.init({
    detection:     'ip|timezone',
    censoredWords: ['VPN', '–≤–ø–Ω', 'Tor', '–ø—Ä–æ–∫—Å–∏'],
    alertText:     '–ú–∞—Ç–µ—Ä–∏–∞–ª –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω –Ω–∞ —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–∏ –†–§',
  }).then(function(result) {
    console.log(result.isRu); // true / false
  });
</script>
```

### CommonJS / AMD

```js
const RuGuard = require('./ru-guard.js');
RuGuard.init().then(console.log);
```

---

## CSS-–∫–ª–∞—Å—Å—ã

–î–æ–±–∞–≤—å—Ç–µ –Ω—É–∂–Ω—ã–µ –∫–ª–∞—Å—Å—ã –∫ HTML-—ç–ª–µ–º–µ–Ω—Ç–∞–º ‚Äî –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∞–µ—Ç –∏—Ö –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.

### –î–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏–∑ –†–æ—Å—Å–∏–∏

| –ö–ª–∞—Å—Å | –≠—Ñ—Ñ–µ–∫—Ç |
|---|---|
| `ru-hide` | `display: none` ‚Äî —ç–ª–µ–º–µ–Ω—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–∫—Ä—ã—Ç |
| `ru-censor` | `filter: blur(30px)` + –≤—ã–¥–µ–ª–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ |
| `ru-censor-alert` | –¢–æ –∂–µ —Ä–∞–∑–º—ã—Ç–∏–µ + —Ç—ë–º–Ω—ã–π –æ–≤–µ—Ä–ª–µ–π ¬´üö´ –ú–∞—Ç–µ—Ä–∏–∞–ª –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω –Ω–∞ —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–∏ –†–§¬ª |
| `ru-censor-words` | –ö–∞–∂–¥–æ–µ –∑–∞–ø—Ä–µ—â—ë–Ω–Ω–æ–µ —Å–ª–æ–≤–æ –≤ —Ç–µ–∫—Å—Ç–µ –±–ª–æ–∫–∞ –æ–±–æ—Ä–∞—á–∏–≤–∞–µ—Ç—Å—è –≤ —Ä–∞–∑–º—ã—Ç—ã–π `<span>` |

### –î–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –Ω–µ –∏–∑ –†–æ—Å—Å–∏–∏

| –ö–ª–∞—Å—Å | –≠—Ñ—Ñ–µ–∫—Ç |
|---|---|
| `ru-only` | `display: none` ‚Äî —ç–ª–µ–º–µ–Ω—Ç —Å–∫—Ä—ã—Ç –æ—Ç –≤—Å–µ—Ö –∑–∞ –ø—Ä–µ–¥–µ–ª–∞–º–∏ –†–æ—Å—Å–∏–∏ |
| `ru-only-alert` | –Ø–Ω—Ç–∞—Ä–Ω—ã–π –æ–≤–µ—Ä–ª–µ–π ¬´‚ö†Ô∏è –≠—Ç–æ—Ç –º–∞—Ç–µ—Ä–∏–∞–ª –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω —Ç–æ–ª—å–∫–æ –¥–ª—è –∞—É–¥–∏—Ç–æ—Ä–∏–∏ –∏–∑ –†–æ—Å—Å–∏–∏¬ª |

### –ü—Ä–∏–º–µ—Ä—ã —Ä–∞–∑–º–µ—Ç–∫–∏

```html
<!-- –°–∫—Ä—ã—Ç—å —Å—Å—ã–ª–∫—É –Ω–∞ –æ–±—Ö–æ–¥ –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫ –æ—Ç —Ä–æ—Å—Å–∏–π—Å–∫–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π -->
<a href="/unblock" class="ru-hide">–ö–∞–∫ –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ —Å–∞–π—Ç—É ‚Üí</a>

<!-- –ü–æ–∫–∞–∑–∞—Ç—å –±–∞–Ω–Ω–µ—Ä —Ç–æ–ª—å–∫–æ –ø–æ—Å–µ—Ç–∏—Ç–µ–ª—è–º –∏–∑ –†–æ—Å—Å–∏–∏ -->
<div class="ru-only">
  –í—ã –ø—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞–µ—Ç–µ –º–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω—É—é –≤–µ—Ä—Å–∏—é —Å–∞–π—Ç–∞.
</div>

<!-- –†–∞–∑–º—ã—Ç—å —Ç–µ–∫—Å—Ç –¥–ª—è —Ä–æ—Å—Å–∏—è–Ω –±–µ–∑ —Å–æ–æ–±—â–µ–Ω–∏—è -->
<article class="ru-censor">
  –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∏–∑ –†–æ—Å—Å–∏–∏ —É–≤–∏–¥—è—Ç, —á—Ç–æ –∑–¥–µ—Å—å –µ—Å—Ç—å —Ç–µ–∫—Å—Ç, –Ω–æ –Ω–µ —Å–º–æ–≥—É—Ç –ø—Ä–æ—á–µ—Å—Ç—å –µ–≥–æ —Å–æ–¥–µ—Ä–∂–∞–Ω–∏–µ
</article>

<!-- –†–∞–∑–º—ã—Ç—å —Å —è–≤–Ω—ã–º –æ–≤–µ—Ä–ª–µ–µ–º "–∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ" -->
<section class="ru-censor-alert">
  –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∏–∑ –†–æ—Å—Å–∏–∏ —É–≤–∏–¥—è—Ç, —á—Ç–æ –∑–¥–µ—Å—å –µ—Å—Ç—å —Ç–µ–∫—Å—Ç, –Ω–æ –≤–º–µ—Å—Ç–æ –Ω–µ–≥–æ —É–≤–∏–¥—è—Ç –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ
</section>

<!-- –ü—Ä–µ–¥—É–ø—Ä–µ–¥–∏—Ç—å –Ω–µ-—Ä–æ—Å—Å–∏–π—Å–∫–∏—Ö –ø–æ—Å–µ—Ç–∏—Ç–µ–ª–µ–π –æ —Ä–µ–≥–∏–æ–Ω–∞–ª—å–Ω–æ–º –∫–æ–Ω—Ç–µ–Ω—Ç–µ -->
<div class="ru-only-alert">
  –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—é –Ω–∞–ª–æ–≥–æ–≤–æ–≥–æ –≤—ã—á–µ—Ç–∞ —á–µ—Ä–µ–∑ –ì–æ—Å—É—Å–ª—É–≥–∏.
</div>

<!-- –†–∞–∑–º—ã—Ç—å —Ç–æ–ª—å–∫–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Å–ª–æ–≤–∞ –ø—Ä—è–º–æ –≤ —Ç–µ–∫—Å—Ç–µ -->
<p class="ru-censor-words">
  –ú–Ω–æ–≥–∏–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç VPN –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–º —Å–∞–π—Ç–∞–º.
  –°–ª–æ–≤–æ ¬´–≤–ø–Ω¬ª –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ.
</p>
```

---

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –¢–∏–ø | –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é | –û–ø–∏—Å–∞–Ω–∏–µ |
|---|---|---|---|
| `detection` | `string` | `'ip\|timezone'` | –†–µ–∂–∏–º –¥–µ—Ç–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è (—Å–º. –Ω–∏–∂–µ) |
| `ipApiUrl` | `string` | `'https://ipapi.co/json/'` | –û—Å–Ω–æ–≤–Ω–æ–π IP API. –î–æ–ª–∂–µ–Ω –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å JSON —Å –ø–æ–ª–µ–º `country_code` |
| `ipApiFallbackUrl` | `string` | `'https://ip-api.com/json/'` | –†–µ–∑–µ—Ä–≤–Ω—ã–π IP API |
| `ipTimeout` | `number` | `4000` | –¢–∞–π–º–∞—É—Ç –∫–∞–∂–¥–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞ –≤ –º—Å |
| `censoredWords` | `string[]` | `['VPN', '–≤–ø–Ω', '–í–ü–ù']` | –°–ª–æ–≤–∞ –¥–ª—è —Ä–∞–∑–º—ã—Ç–∏—è –≤ –±–ª–æ–∫–∞—Ö `.ru-censor-words`. –ü–æ–∏—Å–∫ –±–µ–∑ —É—á—ë—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞ |
| `blurAmount` | `string` | `'30px'` | –†–∞–¥–∏—É—Å CSS-—Ä–∞–∑–º—ã—Ç–∏—è |
| `alertText` | `string` | `'–ú–∞—Ç–µ—Ä–∏–∞–ª –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω –Ω–∞ —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–∏ –†–§'` | –¢–µ–∫—Å—Ç –æ–≤–µ—Ä–ª–µ—è –¥–ª—è `.ru-censor-alert` |
| `nonRuAlertText` | `string` | `'–≠—Ç–æ—Ç –º–∞—Ç–µ—Ä–∏–∞–ª –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω —Ç–æ–ª—å–∫–æ –¥–ª—è –∞—É–¥–∏—Ç–æ—Ä–∏–∏ –∏–∑ –†–æ—Å—Å–∏–∏'` | –¢–µ–∫—Å—Ç –æ–≤–µ—Ä–ª–µ—è –¥–ª—è `.ru-only-alert` |

### –†–µ–∂–∏–º—ã –¥–µ—Ç–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

| –†–µ–∂–∏–º | –û–ø–∏—Å–∞–Ω–∏–µ |
|---|---|
| `'ip\|timezone'` | –†–§, –µ—Å–ª–∏ —Å–æ–≤–ø–∞–ª IP **–∏–ª–∏** TZ. –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –æ—Ö–≤–∞—Ç *(–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)* |
| `'ip+timezone'` | –†–§, —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ —Å–æ–≤–ø–∞–ª–∏ IP **–∏** TZ. –ú–∏–Ω–∏–º—É–º –ª–æ–∂–Ω—ã—Ö —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–π |
| `'ip'` | –¢–æ–ª—å–∫–æ IP. –ü—Ä–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –æ–±–æ–∏—Ö API ‚Äî fallback –Ω–∞ TZ |
| `'timezone'` | –¢–æ–ª—å–∫–æ TZ. –°–∏–Ω—Ö—Ä–æ–Ω–Ω–æ, –±–µ–∑ —Å–µ—Ç–∏, —Ä–∞–±–æ—Ç–∞–µ—Ç –º–≥–Ω–æ–≤–µ–Ω–Ω–æ |

---

## –ü—É–±–ª–∏—á–Ω–æ–µ API

### `RuGuard.init(config?)` ‚Üí `Promise<result>`

–ñ–¥—ë—Ç `DOMContentLoaded`, –∑–∞—Ç–µ–º –∑–∞–ø—É—Å–∫–∞–µ—Ç –¥–µ—Ç–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –ø—Ä–∏–º–µ–Ω—è–µ—Ç –ø—Ä–∞–≤–∏–ª–∞ –∫ DOM. –ë–µ–∑–æ–ø–∞—Å–Ω–æ –≤—ã–∑—ã–≤–∞—Ç—å –≤ –ª—é–±–æ–π –º–æ–º–µ–Ω—Ç.

### `RuGuard.run(config?)` ‚Üí `Promise<result>`

–ó–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ, –µ—Å–ª–∏ –Ω—É–∂–Ω–æ —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä–æ–≤–∞—Ç—å –º–æ–º–µ–Ω—Ç –∑–∞–ø—É—Å–∫–∞ (DOM –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≥–æ—Ç–æ–≤).

### `RuGuard.isRussianUser(config?)` ‚Üí `Promise<boolean>`

–¢–æ–ª—å–∫–æ –¥–µ—Ç–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ, –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π DOM. –£–¥–æ–±–Ω–æ –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ –∏ –∫–∞—Å—Ç–æ–º–Ω–æ–π –ª–æ–≥–∏–∫–∏:

```js
RuGuard.isRussianUser().then(function(isRu) {
  if (isRu) analytics.track('ru_visitor');
});
```

### –û–±—ä–µ–∫—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞

–í—Å–µ —Ç—Ä–∏ –º–µ—Ç–æ–¥–∞ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç –ø—Ä–æ–º–∏—Å —Å –æ–¥–∏–Ω–∞–∫–æ–≤–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π:

```js
{
  // –î–µ—Ç–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
  isRu:    true,           // –∏—Ç–æ–≥–æ–≤–æ–µ —Ä–µ—à–µ–Ω–∏–µ
  method:  'ip|timezone',  // –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã–π —Ä–µ–∂–∏–º
  tzMatch: true,           // —Å–æ–≤–ø–∞–ª –ª–∏ —á–∞—Å–æ–≤–æ–π –ø–æ—è—Å
  ipMatch: true,           // —Å–æ–≤–ø–∞–ª –ª–∏ IP (null ‚Äî –æ–±–∞ API –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã)

  // –ü—Ä–∏–º–µ–Ω—ë–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è DOM
  hidden:       1,  // .ru-hide —Å–∫—Ä—ã—Ç—ã—Ö
  censored:     1,  // .ru-censor —Ä–∞–∑–º—ã—Ç—ã—Ö
  alerts:       1,  // .ru-censor-alert —Å –æ–≤–µ—Ä–ª–µ–µ–º
  wordBlocks:   1,  // .ru-censor-words –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö
  ruOnly:       0,  // .ru-only —Å–∫—Ä—ã—Ç—ã—Ö (–¥–ª—è –Ω–µ-–†–§)
  ruOnlyAlerts: 0,  // .ru-only-alert —Å –æ–≤–µ—Ä–ª–µ–µ–º (–¥–ª—è –Ω–µ-–†–§)
}
```

---

## –¢–æ—á–Ω–æ—Å—Ç—å –¥–µ—Ç–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

| –°–∏–≥–Ω–∞–ª | –ü–ª—é—Å—ã | –ú–∏–Ω—É—Å—ã |
|---|---|---|
| **IP** | –¢–æ—á–Ω–æ, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –º–æ–∂–µ—Ç –ø–æ–¥–º–µ–Ω–∏—Ç—å –±–µ–∑ VPN | –¢—Ä–µ–±—É–µ—Ç —Å–µ—Ç–µ–≤–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞; –ª–∏–º–∏—Ç—ã —É –±–µ—Å–ø–ª–∞—Ç–Ω—ã—Ö API |
| **Timezone** | –ú–≥–Ω–æ–≤–µ–Ω–Ω–æ, –±–µ–∑ —Å–µ—Ç–∏ | –†—É—Å—Å–∫–æ—è–∑—ã—á–Ω—ã–µ —ç–º–∏–≥—Ä–∞–Ω—Ç—ã –∑–∞ —Ä—É–±–µ–∂–æ–º –º–æ–≥—É—Ç –∏–º–µ—Ç—å —Ä–æ—Å—Å–∏–π—Å–∫–∏–π TZ |
| **`ip+timezone`** | –ú–∏–Ω–∏–º—É–º –ª–æ–∂–Ω—ã—Ö —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–π | –ú–æ–∂–µ—Ç –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å VPN-–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å —Ä–æ—Å—Å–∏–π—Å–∫–∏–º TZ |
| **`ip\|timezone`** | –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –æ—Ö–≤–∞—Ç | –í—ã—à–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –ª–æ–∂–Ω—ã—Ö —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–π |

–†–µ–∂–∏–º `'timezone'` ‚Äî –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –≤—ã–±–æ—Ä, –µ—Å–ª–∏ –Ω—É–∂–µ–Ω –ø–æ–ª–Ω–æ—Å—Ç—å—é –∞–≤—Ç–æ–Ω–æ–º–Ω—ã–π —Å–∫—Ä–∏–ø—Ç –±–µ–∑ –∫–∞–∫–∏—Ö-–ª–∏–±–æ –≤–Ω–µ—à–Ω–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤.

---

## –°–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π IP API

–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã (`ipapi.co` –∏ `ip-api.com`) –±–µ—Å–ø–ª–∞—Ç–Ω—ã, –Ω–æ –∏–º–µ—é—Ç –ª–∏–º–∏—Ç—ã. –î–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞ —Ä–∞—Å—Å–º–æ—Ç—Ä–∏—Ç–µ:

- **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ** ‚Äî —Å–æ—Ö—Ä–∞–Ω—è–π—Ç–µ –∫–æ–¥ —Å—Ç—Ä–∞–Ω—ã –≤ `sessionStorage` –ø–æ—Å–ª–µ –ø–µ—Ä–≤–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –æ–±—Ä–∞—â–µ–Ω–∏–π –∫ API.
- **Self-hosting** ‚Äî —Ä–∞–∑–≤–µ—Ä–Ω–∏—Ç–µ [ip-api](https://ip-api.com/docs/api:json) –Ω–∞ —Å–≤–æ–µ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–µ –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –±–∞–∑—É [MaxMind GeoLite2](https://dev.maxmind.com/geoip/geolite2-free-geolocation-data) —Å –ø—Ä–æ–∫—Å–∏.

–ü–æ–¥–æ–π–¥—ë—Ç –ª—é–±–æ–π —ç–Ω–¥–ø–æ–∏–Ω—Ç, –≤–æ–∑–≤—Ä–∞—â–∞—é—â–∏–π JSON —Å –ø–æ–ª–µ–º `country_code` –∏–ª–∏ `countryCode` (ISO 3166-1 alpha-2):

```js
RuGuard.init({
  ipApiUrl:         'https://geo.yoursite.com/api/me',
  ipApiFallbackUrl: 'https://ipapi.co/json/', // –æ—Å—Ç–∞–≤—å—Ç–µ –ø—É–±–ª–∏—á–Ω—ã–π —Ä–µ–∑–µ—Ä–≤
});
```

---

## –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –±—Ä–∞—É–∑–µ—Ä–æ–≤

–†–∞–±–æ—Ç–∞–µ—Ç –≤–æ –≤—Å–µ—Ö —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –±—Ä–∞—É–∑–µ—Ä–∞—Ö. –¢—Ä–µ–±—É–µ—Ç `fetch` –∏ `Promise` (–Ω–∞—Ç–∏–≤–Ω–æ —Å Chrome 42 / Firefox 40 / Safari 10.1). –î–ª—è IE11 –¥–æ–±–∞–≤—å—Ç–µ –ø–æ–ª–∏—Ñ–∏–ª–ª—ã –ø–µ—Ä–µ–¥ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ–º –±–∏–±–ª–∏–æ—Ç–µ–∫–∏.

---

## –õ–∏—Ü–µ–Ω–∑–∏—è

MIT ¬© 2026

---

<a name="english"></a>

<p align="center">
  <a href="#">RU</a> ¬∑ <b>EN</b>
</p>

---

A lightweight, dependency-free JavaScript library that detects Russian users and controls content visibility ‚Äî hiding, blurring, or annotating blocks with region-specific messages. One file, zero dependencies.

```html
<!-- Zero-config auto mode -->
<script src="ru-guard.js" data-auto></script>
```

---

## Table of Contents

- [How it works](#how-it-works)
- [Quick start](#quick-start)
- [CSS classes](#css-classes)
- [Configuration](#configuration)
- [Public API](#public-api)
- [Detection accuracy](#detection-accuracy)
- [Hosting your own IP API](#hosting-your-own-ip-api)
- [Browser support](#browser-support)
- [License](#license-1)

---

## How it works

```
User visits the site
        ‚îÇ
        ‚ñº
Fetch ipapi.co (IP geolocation)
        ‚îÇ
   ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îê
success    error
   ‚îÇ           ‚îÇ
   ‚ñº           ‚ñº
Country     Fetch ip-api.com (fallback)
by IP           ‚îÇ
   ‚îÇ       ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îê
   ‚îÇ    success    error
   ‚îÇ       ‚îÇ           ‚îÇ
   ‚îÇ       ‚ñº           ‚ñº
   ‚îÇ    Country     Timezone
   ‚îÇ    by IP       via Intl API
   ‚îÇ       ‚îÇ           ‚îÇ
   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                ‚îÇ
                ‚ñº
     Apply detection mode:
     'ip|timezone'  ‚Üí IP or TZ matches
     'ip+timezone'  ‚Üí IP and TZ both match
     'ip'           ‚Üí IP only
     'timezone'     ‚Üí TZ only
                ‚îÇ
          ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
       Russia       Not Russia
          ‚îÇ               ‚îÇ
          ‚ñº               ‚ñº
     ru-hide          ru-only ‚Üí hide
     ru-censor        ru-only-alert ‚Üí overlay
     ru-censor-alert
     ru-censor-words
```

If both IP APIs are unavailable, detection gracefully falls back to timezone. The library covers all 20 Russian IANA timezone zones from Kaliningrad to Anadyr.

---

## Quick start

### Auto mode

```html
<script src="ru-guard.js" data-auto></script>
```

The `data-auto` attribute triggers `RuGuard.init()` automatically as soon as the script loads.

### Manual init

```html
<script src="ru-guard.js"></script>
<script>
  RuGuard.init({
    detection:     'ip|timezone',
    censoredWords: ['VPN', '–≤–ø–Ω', 'Tor', 'proxy'],
    alertText:     'This content is blocked in Russia',
  }).then(function(result) {
    console.log(result.isRu); // true / false
  });
</script>
```

### CommonJS / AMD

```js
const RuGuard = require('./ru-guard.js');
RuGuard.init().then(console.log);
```

---

## CSS classes

Mark your HTML elements with these classes ‚Äî the library processes them automatically at runtime.

### For Russian visitors

| Class | Effect |
|---|---|
| `ru-hide` | `display: none` ‚Äî element is completely hidden |
| `ru-censor` | `filter: blur(30px)` + text selection disabled |
| `ru-censor-alert` | Same blur + dark overlay "üö´ Material is blocked in Russia" |
| `ru-censor-words` | Every censored word in the block's text is individually wrapped in a blurred `<span>` |

### For non-Russian visitors

| Class | Effect |
|---|---|
| `ru-only` | `display: none` ‚Äî element is hidden from everyone outside Russia |
| `ru-only-alert` | Amber overlay "‚ö†Ô∏è This content is intended for a Russian audience only" |

### Usage examples

```html
<!-- Hide a bypass-censorship link from Russian users -->
<a href="/unblock" class="ru-hide">How to access blocked sites ‚Üí</a>

<!-- Show a banner only to visitors from Russia -->
<div class="ru-only">
  You are viewing the international version of this site.
</div>

<!-- Blur article text for Russian users, no message -->
<article class="ru-censor">
  Blur article text for Russian users, no message
</article>

<!-- Blur with an explicit "blocked" overlay -->
<section class="ru-censor-alert">
  Blur with an explicit "blocked" overlay
</section>

<!-- Warn non-Russian visitors that content is region-specific -->
<div class="ru-only-alert">
  Instructions for filing a tax deduction via Russian public services portal.
</div>

<!-- Blur only specific forbidden words inline -->
<p class="ru-censor-words">
  Many users rely on VPN services to access blocked websites.
  The word ¬´–≤–ø–Ω¬ª is treated the same way.
</p>
```

---

## Configuration

| Option | Type | Default | Description |
|---|---|---|---|
| `detection` | `string` | `'ip\|timezone'` | Detection mode (see below) |
| `ipApiUrl` | `string` | `'https://ipapi.co/json/'` | Primary IP API. Must return JSON with a `country_code` field |
| `ipApiFallbackUrl` | `string` | `'https://ip-api.com/json/'` | Fallback IP API |
| `ipTimeout` | `number` | `4000` | Timeout per request in ms |
| `censoredWords` | `string[]` | `['VPN', '–≤–ø–Ω', '–í–ü–ù']` | Words to blur inside `.ru-censor-words` blocks. Case-insensitive |
| `blurAmount` | `string` | `'30px'` | CSS blur radius |
| `alertText` | `string` | `'–ú–∞—Ç–µ—Ä–∏–∞–ª –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω –Ω–∞ —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–∏ –†–§'` | Overlay text for `.ru-censor-alert` |
| `nonRuAlertText` | `string` | `'–≠—Ç–æ—Ç –º–∞—Ç–µ—Ä–∏–∞–ª –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω —Ç–æ–ª—å–∫–æ –¥–ª—è –∞—É–¥–∏—Ç–æ—Ä–∏–∏ –∏–∑ –†–æ—Å—Å–∏–∏'` | Overlay text for `.ru-only-alert` |

### Detection modes

| Mode | Description |
|---|---|
| `'ip\|timezone'` | Russian if IP **or** TZ matches. Broadest coverage *(default)* |
| `'ip+timezone'` | Russian only if IP **and** TZ both match. Fewest false positives |
| `'ip'` | IP only. Falls back to TZ if both APIs are unreachable |
| `'timezone'` | TZ only. Synchronous, no network, instant |

---

## Public API

### `RuGuard.init(config?)` ‚Üí `Promise<result>`

Waits for `DOMContentLoaded`, then runs detection and applies all DOM rules. Safe to call at any point.

### `RuGuard.run(config?)` ‚Üí `Promise<result>`

Runs immediately. Use when you need to control the timing yourself (DOM must already be ready).

### `RuGuard.isRussianUser(config?)` ‚Üí `Promise<boolean>`

Detection only ‚Äî no DOM changes. Use for analytics or custom logic:

```js
RuGuard.isRussianUser().then(function(isRu) {
  if (isRu) analytics.track('ru_visitor');
});
```

### Result object

All three methods resolve with the same shape:

```js
{
  // Detection
  isRu:    true,           // final verdict
  method:  'ip|timezone',  // detection mode used
  tzMatch: true,           // did the timezone match?
  ipMatch: true,           // did the IP match? (null if both APIs failed)

  // DOM changes applied
  hidden:       1,  // .ru-hide elements hidden
  censored:     1,  // .ru-censor elements blurred
  alerts:       1,  // .ru-censor-alert elements blurred + overlaid
  wordBlocks:   1,  // .ru-censor-words blocks processed
  ruOnly:       0,  // .ru-only elements hidden (non-RU visitors)
  ruOnlyAlerts: 0,  // .ru-only-alert elements overlaid (non-RU visitors)
}
```

---

## Detection accuracy

| Signal | Pros | Cons |
|---|---|---|
| **IP** | Accurate, users cannot spoof it without a VPN | Requires a network request; rate-limited free APIs |
| **Timezone** | Instant, no network | Russian-speaking expats may have a Russian TZ |
| **`ip+timezone`** | Fewest false positives | May miss VPN users who kept a Russian TZ |
| **`ip\|timezone`** | Maximum coverage | Higher chance of false positives |

The `'timezone'`-only mode is the right choice when you need a fully self-contained script with no external requests.

---

## Hosting your own IP API

The default endpoints (`ipapi.co` and `ip-api.com`) are free but rate-limited. For production consider:

- **Caching** ‚Äî store the country code in `sessionStorage` after the first lookup to avoid repeat requests.
- **Self-hosting** ‚Äî deploy [ip-api](https://ip-api.com/docs/api:json) or use [MaxMind GeoLite2](https://dev.maxmind.com/geoip/geolite2-free-geolocation-data) with a proxy.

Any endpoint returning JSON with a `country_code` or `countryCode` field (ISO 3166-1 alpha-2) works automatically:

```js
RuGuard.init({
  ipApiUrl:         'https://geo.yoursite.com/api/me',
  ipApiFallbackUrl: 'https://ipapi.co/json/', // keep a public fallback
});
```

---

## Browser support

Works in all modern browsers. Requires `fetch` and `Promise` (native since Chrome 42 / Firefox 40 / Safari 10.1). For IE11 support add polyfills before loading the library.

---

## License

MIT ¬© 2026
